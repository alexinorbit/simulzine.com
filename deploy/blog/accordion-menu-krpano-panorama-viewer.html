<!doctype html>
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
    <meta charset=""
  <meta http-equiv="X-UA-Compatible" content="">
  <title>Accordion Menu Generator for the krPano Panorama Viewer</title>
  <meta name="description" content="how the accordion menu generator works
">
  <meta name="author" content="Alex Giannakidis">
  <meta name="viewport" content="">
   <link href='http://fonts.googleapis.com/css?family=Audiowide|Ubuntu|Open+Sans:400,300,300italic,400italic,600,600italic,700,800italic|Muli:300,300italic,400,400italic&subset=latin,greek-ext' rel='stylesheet' type='text/css'>
      <!-- Place favicon.ico & apple-touch-icon.png
        in the root of your domain and delete these references -->
  <link rel="shortcut icon" href="/media/favicon.ico">
  <link rel="apple-touch-icon" href="/media/apple-touch-icon.png">
  


    <link rel="stylesheet" href="/media/css/syntaxhighlighter/styles/shCoreMidnight.css" type="text/css" >
  <link rel="stylesheet" href="/media/css/site.css" >
  
     <script type="text/javascript" src="/media/css/syntaxhighlighter/scripts/shCore.js"></script>
   <script type="text/javascript" src="/media/css/syntaxhighlighter/scripts/shAutoloader.js"></script>
    <script src="/media/js/libs/modernizr-1.7.min.js"></script>
    </head>
<body id="accordion-menu-krpano-panorama-viewer">
    <div id="container">
            <div id="main" role="main">
          <header class="banner clearfix">
          <a href="http://www.simulzine.com/index.html"> <h1>SIMULZINE</h1> <a/>
           <a href="http://www.simulzine.com/about.html"> <h3>by Alex(andros) Giannakidis</h3> </a>                              <nav class=main_nav>
    <ul>
                <li>
            <a title="Home Page"
                class="button white home"
                href="/index.html">
                home
            </a>
        </li>        <li>
            <a title="Blog"
                class="button white active blog"
                href="/blog">
                articles
            </a>
        </li>        <li>
            <a title="About"
                class="button white about"
                href="/about.html">
                info
            </a>
        </li>    </ul>
</nav>
                    </header>
          <section class="content">
<article class="post">

  <nav class="post_nav">
    <h0>SIMULZINE</h0>

    <h1 class="title">
        <a href="/blog/accordion-menu-krpano-panorama-viewer.html">
            Accordion Menu Generator for the krPano Panorama Viewer
        </a>
    </h1>
    <time datetime="2013-08-01">
        Posted: 01 Aug 2013
    </time>
    <a class="button white backlink" href="/blog">all articles</a>
  </nav>

<div class="inArticleTitle">
	Accordion Menu Generator for the krPano Panorama Viewer
</div>
<time datetime="2013-08-01">
    Posted: 01 Aug 2013
</time>
<p><img alt="SIMULZINE#3-cover-accordion-menu-generator" src="/media/images/accordion.png" />
<div class="button_demo_container">
<a class="button_demo white" href="http://simulzine.com/projects/accordion-menu-generator/krpano/" target="_blank">generate an accordion menu &#187;&#187;</a>
</div></p>
<p>An accordion menu is an often used element by <span class="caps">GUI</span> designers. It comes handy because it&#8217;s a &#8220;spacesaver&#8221; in rich applications that need to have their content easily accessible. Especially in mobile devices, accordions menus are found everywhere. In this post I present an accordion menu generator for the krpano panorama viewer, that recently got compatible with mobile devices (through webGL or css3D). This is also my first open source project&nbsp;:)</p>
<h1 id="how-this-project-started">How this project&nbsp;started</h1>
<p>I prepared a static version of an animated accordion menu, last year, for use in the Acropolis Virtual Tour. After some people in the krpano forums requested the code for the menu, I started to build a dynamic version which could generate a menu based on some essential parameters. Lately the project evolved and got a front-end for novice users to test and generate their menu on the fly. The code of the generated menu is highly customizable in terms of style and functionality. The code is publicly available on github, as a separete repository, and can be improved or extended with other features by anyone&nbsp;interested.</p>
<h1 id="essentials-of-an-accordion-in-the-graphical-user-interface">Essentials of an accordion in the graphical user&nbsp;interface</h1>
<p>According to wikipedia: <span class="italic_style">an accordion is a vertically stacked list of items (e.g. labels or thumbnails). Each item can be &#8220;expanded&#8221; or &#8220;stretched&#8221; to reveal the content associated with that item. There can be zero or more items expanded at a time, depending on the configuration.</span> In our case I split the accordion menu in groups and events. Groups are the items that can be expanded and reveal the event buttons. A group can have numerous events. Another important aspect of our approach are formations. When a group becomes active the according formation animates the other objects to reveal the event buttons associated with&nbsp;it.</p>
<h1 id="variables-of-the-generator">Variables of the&nbsp;generator</h1>
<p>The following figure depicts the required user input to generate the accordion. Blue dotted lines refer to dimensions (width, height, position) and green lines refer to quantity.
All dimensions are in % (percentage) of the viewers width and height. Please take into consideration that this figure is only a part of&nbsp;viewer.</p>
<p><img alt="accordion variables" src="/media/images/accordion-vars.png" />
<div class="image_section">
    <span class="image_figure">figure 1</span><br>
    user variables to generate the accordion menu<br>
    <div id="legend">
      <span style="font-weight:400;">X</span>: x position of menu (origin top left),
      <span style="font-weight:400;">Y</span>: y position of menu (origin top left),
      <span style="font-weight:400;"><span class="caps">MW</span></span>: width of menu,
      <span style="font-weight:400;"><span class="caps">GH</span></span>: group buttons height,
      <span style="font-weight:400;"><span class="caps">EH</span></span>: event buttons height,
      <span style="font-weight:400;"><span class="caps">GN</span></span>: quantity of group buttons,
      <span style="font-weight:400;"><span class="caps">G1EN</span></span>: quantity of event buttons for group 1
    </div>
</div></p>
<h1 id="a-quick-look-at-the-code">A quick look at the&nbsp;code</h1>
<p>The krpano viewer is a fully functional panoramic rendering engine. It uses xml code for storing static settings and has its own dynamic scripting language, also called krpano script, when more advanced features, like custom variables and functions, are needed. When embeding the viewer into <span class="caps">HTML</span>, a <span class="caps">DOM</span> element is created that can be manipulated via javascript. This structure helps novice users to have a project up and running quickly (with the default settings), and at the same time gives developers the required tools to make unique customized stuff. <br /></p>
<p>What follows is the main function (also called action) for the generation of an accordion menu based on user input. It is about sequencial placing of group/event buttons and assigning the according properties (labels, onclick events, styles, etc.) to&nbsp;them.</p>
<div id="codebox" style="">
<pre class="brush: xml">

<action name="createMenu"> <!-- Generator of Accordion Menu -->
setParameters(); <!-- set initial values of menu position -->
<!-- keep previous and current x, y positions of a pointer in the generation process -->
set(ypos,0);
set(xpos, get(varX));
set(ypos2,0);
set(xpos2, get(varX));
add(ypos,varY);

<!-- start procedural generation of menu -->
for(set(i,1), i le varGN, inc(i), <!-- varGN is quantity of group buttons -->
    txtadd(pname, 'Btn_Group', get(i)); <!-- add custom text on group button -->
    txtadd(xpos_percent,get(xpos), '%');
    txtadd(ypos_percent,get(ypos), '%');
    txtadd(gformation, 'GroupFormation', get(i), '()');
    addgroupBTN(get(pname), get(xpos_percent), get(ypos_percent), get(varMW_percent), get(varGH_percent)); <!-- create and add a group button on specified X and Y positions based on parsed values-->
    set(plugin[%pname].onclick, get(gformation)); <!-- set onclick event of newly created group button -->
    <!-- specify current Y position (ypos2) for generating event buttons  -->
    mul(ypos2,i, varGH);
    add(ypos2,varY);
        if(i == 1, set(varGNx, get(varG1EN)); );  <!-- varG1EN is quantity of event buttons for first group -->
        if(i == 2, set(varGNx, get(varG2EN)); );  <!-- varG2EN is quantity of event buttons for second group -->
        if(i == 3, set(varGNx, get(varG3EN)););  <!-- varG3EN is quantity of event buttons for third group -->
        if(i == 4, set(varGNx, get(varG4EN)););  <!-- varG4EN is quantity of event buttons for fourth group -->
        for(set(k,1), k le varGNx, inc(k), <!-- varGNx is quantity of current group -->
            txtadd(pname, 'Btn_Group', get(i),'_event_', get(k)); <!-- add custom text on event button -->
            txtadd(xpos_percent,get(xpos), '%');
            txtadd(ypos2_percent,get(ypos2), '%');
            txtadd(gformation, 'GroupFormation', get(i), '()');
            addeventBTN(get(pname), get(xpos_percent), get(ypos2_percent), get(varew_percent), get(varEH_percent));  <!-- create and add an event button on specified X and Y positions based on parsed values-->
            inc(ypos2,get(varEH)); <!--increase current Y positions by height of event buttons -->
            set(plugin[%pname].onclick, get(gformation)); <!-- set onclick event of newly created event button -->
            );
    );
</action>
</pre>
</div>

<p>Group and Event buttons are added based on the following custom functions. They are based on the textfield plugin that comes with the krpano viewer, but it can be replaced by other plugins or tailored&nbsp;images.</p>
<div id="codebox" style="">
<pre class="brush: xml">

<action name="createGbutton"> <!-- action to create dynamically a Group textfield based button -->
        addplugin(get(pname));
        set(plugin[%pname].html,[p]%1[/p]);
        set(plugin[%pname].x,%2);
        set(plugin[%pname].y,%3);
        set(plugin[%pname].width,%4);
        set(plugin[%pname].height,%5);
        set(plugin[%pname].url, plugins/textfield.swf);
        plugin[%pname].loadstyle(GroupButtonsStyle)
</action>

<action name="createEbutton"> <!-- action to create dynamically an Event textfield based button -->
        addplugin(get(pname));
        set(plugin[%pname].html,[p]%1[/p]);
        set(plugin[%pname].x,%2);
        set(plugin[%pname].y,%3);
        set(plugin[%pname].width,%4);
        set(plugin[%pname].height,%5);
        set(plugin[%pname].url, plugins/textfield.swf);
        plugin[%pname].loadstyle(EventButtonsStyle)
</action>

<action name="addgroupBTN"> <!-- action to add Group button on stage -->
        createGbutton(%1, %2, %3, %4, %5);
        inc(ypos,get(varGH));
</action>

<action name="addeventBTN"> <!-- action to add Event button on stage -->
        createEbutton(%1, %2, %3, %4, %5);
</action>

</pre>
</div>

<p>Another important aspect of the accordion are the different formations (or states) that are triggered based on which Group Button is active (as mentioned earlier). Formations are not generated on the fly (eg. dynamic). I&#8217;ve scripted the first four of them statically, so currently the menu is limited to 4 group buttons.  For example the code for Group 2 is&nbsp;:</p>
<div id="codebox" style="">
<pre class="brush: xml">

<action name="GroupFormation2">
<!-- Expand Group 2 Button, Show event buttons of Group 2, Move rest of Group Buttons to convinient position, Hide the rest of event buttons -->
hideGroup3();
hideGroup1();
hideGroup4();
set(plugin[Btn_Group3].blendmode, normal);
set(plugin[Btn_Group4].blendmode, normal);
set(plugin[Btn_Group1].blendmode, normal);
set(plugin[Btn_Group2].blendmode, hardlight);
mul(varqevents2, varG2EN, varEH);
add(varg2l2,varqevents2,varGH);
txtadd(varg2l2_percent,get(varg2l2), '%');
tween(plugin[Btn_Group1].height, get(varGH_percent));
tween(plugin[Btn_Group2].height, get(varg2l2_percent));
tween(plugin[Btn_Group3].height, get(varGH_percent));
tween(plugin[Btn_Group4].height, get(varGH_percent));
set(varg2y2,get(varg2y0));
add(varg3y2, varg2y2, varg2l2);
txtadd(varg3y2_percent,get(varg3y2), '%');
add(varg4y2, varg3y2, varGH);
txtadd(varg4y2_percent,get(varg4y2), '%');
tween(plugin[Btn_Group2].y, get(varg2y0_percent));
tween(plugin[Btn_Group3].y, get(varg3y2_percent));
tween(plugin[Btn_Group4].y, get(varg4y2_percent));
showGroup2();
set(plugin[Btn_Group1].enabled,true);
set(plugin[Btn_Group2].enabled,false);
set(plugin[Btn_Group3].enabled,true);
set(plugin[Btn_Group4].enabled,true);
</action>

</pre>
</div>

<p>To name and set the onclick events of the buttons based on your preference include this in your code (for every button)&nbsp;:</p>
<div id="codebox" style="">
<pre class="brush: xml">

set(plugin[Btn_Group2_event_1].html,[p]In the main Gorge 1[/p]);
set(plugin[Btn_Group2_event_1].onclick,loadscene_2());

</pre>
</div>

<h1 id="specifics-of-our-krpano-accordion-menu">Specifics of our  krpano Accordion&nbsp;Menu</h1>
<ul>
<li>currently supports up to four Groups and six Events per Group, but can be easily extended to&nbsp;more</li>
<li>uses .blendmode property (currently not supported in <span class="caps">HTML5</span>&nbsp;version)</li>
<li>can be custom styled based on your design - just edit the according style&nbsp;entities</li>
<li>only one group expanded at a&nbsp;time</li>
<li>works with text labels (eg. textfield plugin) but can be edited to work with images&nbsp;also</li>
<li>all dimensions are in % (percentage) of the viewers width and&nbsp;height.</li>
</ul>
<h1 id="the-github-repository">The github&nbsp;repository</h1>
<p>As mentioned earlier I&#8217;ve creted a github repository to host the code of the generator. I&#8217;m planning to extend the project with an image based accordion menu in the future like the one you can see in the Acropolis Virtual Tour when you click at the &#8220;Detail Views&#8221; button. I also hope that I get some help from other krpano developers for this next&nbsp;task.</p>
<div class="button_demo_container">
<a class="button_demo white" href="https://github.com/alexinorbit/accordion-menu-generator" target="_blank">view github repository &#187;&#187;</a>
</div>
<div class="article_tags">
<ul class="tags clear">
tags:
<li>
    <a class="small" href="/blog/tags/krpano.html">
        krpano
    </a>
</li>
<li>
    <a class="small" href="/blog/tags/accordion_menu.html">
        accordion_menu
    </a>
</li>
<li>
    <a class="small" href="/blog/tags/open_source.html">
        open_source
    </a>
</li>
<li>
    <a class="small" href="/blog/tags/GUI.html">
        GUI
    </a>
</li>
<li>
    <a class="small" href="/blog/tags/github.html">
        github
    </a>
</li>
</ul>
</div>
</article><div class="social_buttons">
<a href="https://twitter.com/share" class="twitter-share-button" data-via="alexinorbit">Tweet</a>
<div class="g-plusone"></div>
</div>
</section>

<div class="prev_next">
	<a class="prev"
	title="Gigapixel Imaging at the Acropolis of Athens - Parthenon"
        href="/blog/gigapixel-imaging-at-the-Acropolis-of-Athens-Parthenon-east-facade.html" >
	Gigapixel Imaging at the Acropolis of Athens - Parthenon
	</a>
	<a class="next"
    title="Generating 2d sprites using animated 3d models"
        href="/blog/2d-sprite-animations-using-3d-models-in-blender.html" >
	  Generating 2d sprites using animated 3d models
	</a>
</div>      </div>

      </div> <!--! end of #container -->
  <footer>
    <a href="http://creativecommons.org/licenses/by-sa/3.0/" target="_blank">creative commons license</a>, 2012-2016, Alex(andros) Giannakidis |
    static pages generated with <a href="https://github.com/hyde/hyde" target="_blank">hyde</a> <br/>
    view <a href="https://github.com/alexinorbit/simulzine.com" target="_blank">source</a> on github,
    subscribe to <a href="/atom.xml" target="_blank">rss</a>
  </footer>
      <script type="text/javascript">
		SyntaxHighlighter.autoloader(
  			'js jscript javascript      /media/css/syntaxhighlighter/scripts/shBrushJScript.js',
  			'xml xhtml xslt html xhtml  /media/css/syntaxhighlighter/scripts/shBrushXml.js'

		);
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.defaults['gutter'] = false;
	SyntaxHighlighter.all();
	</script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="js/libs/jquery-1.7.2.min.js">\x3C/script>')</script>
     <script type="text/javascript">
 $(".post_nav").css("visibility", "hidden");
    $(window).scroll(function () {
		var d = $(window).scrollTop();
    	if (d > 200 )
    		{
      			$(".post_nav").css("visibility", "visible");
      			$(".post_nav").fadeIn("slow");
      		};
      	if (d < 200 )
    		{
      			$(".post_nav").fadeOut("slow");
      		};
    });
</script>
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

    <!-- asynchronous google analytics: mathiasbynens.be/notes/async-analytics-snippet
       change the UA-XXXXX-X to be your site's ID -->
<script>
    var _gaq = [['_setAccount', 'UA-30895874-1'], ['_trackPageview']];
    (function(d, t) {
    var g = d.createElement(t),
        s = d.getElementsByTagName(t)[0];
    g.async = true;
    g.src = ('https:' == location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g, s);
    })(document, 'script');
</script>
  
  </body>
</html>